# --- Window Rules (Optimized) ---

# Idle inhibition (Prevent sleep/screensaver for any fullscreen window)
windowrule = idleinhibit fullscreen, fullscreen:1

# Prevent maximize events (use fullscreen instead)
windowrule = suppressevent maximize, class:.*

# Handle specific empty XWayland windows (keep if needed for specific issues)
# windowrule = nofocus,class:^$,title:^$,xwayland:1,floating:1,fullscreen:0,pinned:0 # Uncomment if you observe issues with invisible Xwayland placeholders

# --- Floating Window Rules ---
# File dialogs and progress bars
windowrule = float, initialTitle:^(Open File|Choose Files|Save As|Confirm to replace files)$
windowrule = float, title:^(File Operation Progress)$
windowrule = float, class:^(org.kde.dolphin)$, title:^(Progress Dialog — Dolphin|Copying — Dolphin)$
windowrule = float, class:^(org.kde.ark)$ # Ark extraction/compression dialogs often benefit from floating

# Specific utility/small windows
windowrule = float, title:^(About Mozilla Firefox)$
windowrule = float, class:^(firefox)$, title:^(Picture-in-Picture|Library)$
windowrule = float, class:^(kitty)$, title:^(top|btop|htop)$
windowrule = float, class:^(vlc)$
windowrule = float, class:^(eog)$ # Gnome image viewer
windowrule = float, class:^(Signal)$ # Signal main window (preference)
windowrule = float, class:^(com.github.rafostar.Clapper)$ # Clapper media player
windowrule = float, class:^(xdg-desktop-portal-gtk)$ # GTK Portal/file chooser

# Theme/Appearance tools
windowrule = float, class:^(kvantummanager|qt5ct|qt6ct|nwg-look)$

# System control applets/agents
windowrule = float, class:^(org.pulseaudio.pavucontrol|blueman-manager|nm-applet|nm-connection-editor|org.kde.polkit-kde-authentication-agent-1)$

# Various Flatpak/Utility Apps (Grouped)
windowrule = float, class:^(app.drey.Warp|net.davidotek.pupgui2|yad|io.github.alainm23.planify|io.gitlab.theevilskeleton.Upscaler|com.github.unrud.VideoDownloader|io.gitlab.adhami3310.Impression|io.missioncenter.MissionCenter)$


# --- Opacity Rules (Active & Inactive & Fullscreen=Opaque) ---
# Browsers
windowrulev2 = opacity 0.90 0.90 1, class:^(firefox|Brave-browser)$

# Terminals / Dev Tools / File Managers
windowrulev2 = opacity 0.80 0.80 1, class:^([Cc]ode|code-oss|code-url-handler|code-insiders-url-handler)$ # VSCode variants
windowrulev2 = opacity 0.80 0.80 1, class:^(kitty)$
windowrulev2 = opacity 0.80 0.80 1, class:^(org.kde.dolphin|org.kde.ark)$ # Dolphin & Ark

# Theme/Appearance tools
windowrulev2 = opacity 0.80 0.80 1, class:^(nwg-look|qt5ct|qt6ct|kvantummanager)$

# System control applets/agents (Slightly more transparent when inactive)
windowrulev2 = opacity 0.80 0.70 1, class:^(org.pulseaudio.pavucontrol|blueman-manager|nm-applet|nm-connection-editor|org.kde.polkit-kde-authentication-agent-1|polkit-gnome-authentication-agent-1)$

# Portal implementations (Slightly more transparent when inactive)
windowrulev2 = opacity 0.80 0.70 1, class:^(org\.freedesktop\.impl\.portal\.desktop\.(gtk|hyprland))$

# Media / Social / Gaming (More transparent)
windowrulev2 = opacity 0.70 0.70 1, class:^([Ss]team|steamwebhelper)$ # Steam client & helper
windowrulev2 = opacity 0.70 0.70 1, class:^([Ss]potify)$ # Spotify client

# Discord Clients
windowrulev2 = opacity 0.80 0.80 1, class:^(vesktop|discord|WebCord|ArmCord)$

# Various Flatpak/Utility Apps (Grouped)
windowrulev2 = opacity 0.80 0.80 1, class:^(com.github.tchx84.Flatseal|hu.kramo.Cartridges|com.obsproject.Studio|gnome-boxes|app.drey.Warp|net.davidotek.pupgui2|yad|Signal|io.github.alainm23.planify|io.gitlab.theevilskeleton.Upscaler|com.github.unrud.VideoDownloader|io.gitlab.adhami3310.Impression|io.missioncenter.MissionCenter|io.github.flattool.Warehouse)$

# Specific Media Player (Different opacity level)
windowrulev2 = opacity 0.90 0.90 1, class:^(com.github.rafostar.Clapper)$


# --- Layer Rules ---
# Blur for specific UI elements (Ensure 'ignorezero' if they have transparency)
# layerrule = blur, rofi
# layerrule = ignorezero, rofi
layerrule = blur, notifications
layerrule = ignorezero, notifications
# layerrule = blur, swaync-notification-window
# layerrule = ignorezero, swaync-notification-window
# layerrule = blur, swaync-control-center
# layerrule = ignorezero, swaync-control-center
layerrule = blur, logout_dialog # Assuming 'logout_dialog' is a layer surface identifier
# Add rules for waybar/wofi/dunst here if you still use them alongside/instead of the above
layerrule = blur, waybar
layerrule = ignorezero, waybar
layerrule = blur, wofi
layerrule = ignorezero, wofi
layerrule = blur, dunst
layerrule = ignorezero, dunst
